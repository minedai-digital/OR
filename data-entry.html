<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>إدخال البيانات - نظام إدارة العمليات المستشفى</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@300;400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="assets/css/styles.css">
</head>
<body class="bg-gray-50 font-cairo">
    <!-- Navigation Bar -->
    <nav class="bg-white shadow-lg">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <div class="flex-shrink-0 flex items-center">
                        <i class="fas fa-hospital text-2xl text-blue-600 ml-2"></i>
                        <span class="text-xl font-bold text-gray-900">نظام إدارة العمليات</span>
                    </div>
                </div>
                
                <div class="flex items-center space-x-8">
                    <div class="hidden md:flex space-x-8">
                        <a href="dashboard.html" class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">
                            <i class="fas fa-home ml-1"></i>الرئيسية
                        </a>
                        <a href="analysis.html" class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">
                            <i class="fas fa-chart-bar ml-1"></i>تحليل البيانات
                        </a>
                        <a href="daily-data.html" class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">
                            <i class="fas fa-calendar-day ml-1"></i>البيانات اليومية
                        </a>
                        <a href="gallery.html" class="text-gray-700 hover:text-blue-600 px-3 py-2 rounded-md text-sm font-medium">
                            <i class="fas fa-images ml-1"></i>المعرض
                        </a>
                    </div>
                    
                    <button onclick="AuthManager.logout()" class="text-gray-700 hover:text-red-600 px-3 py-2 rounded-md text-sm font-medium">
                        <i class="fas fa-sign-out-alt ml-1"></i>تسجيل الخروج
                    </button>
                </div>
            </div>
        </div>
    </nav>

    <!-- Mobile Navigation -->
    <div class="md:hidden bg-white shadow-lg">
        <div class="px-2 pt-2 pb-3 space-y-1 sm:px-3">
            <a href="dashboard.html" class="text-gray-700 hover:text-blue-600 block px-3 py-2 rounded-md text-base font-medium">
                <i class="fas fa-home ml-1"></i>الرئيسية
            </a>
            <a href="analysis.html" class="text-gray-700 hover:text-blue-600 block px-3 py-2 rounded-md text-base font-medium">
                <i class="fas fa-chart-bar ml-1"></i>تحليل البيانات
            </a>
            <a href="daily-data.html" class="text-gray-700 hover:text-blue-600 block px-3 py-2 rounded-md text-base font-medium">
                <i class="fas fa-calendar-day ml-1"></i>البيانات اليومية
            </a>
            <a href="gallery.html" class="text-gray-700 hover:text-blue-600 block px-3 py-2 rounded-md text-base font-medium">
                <i class="fas fa-images ml-1"></i>المعرض
            </a>
        </div>
    </div>

    <!-- Main Content -->
    <div class="max-w-7xl mx-auto py-6 sm:px-6 lg:px-8">
        <div class="px-4 py-6 sm:px-0">
            <div class="bg-white shadow-lg rounded-lg p-6">
                <h1 class="text-3xl font-bold text-gray-900 mb-6">
                    <i class="fas fa-plus-circle ml-2"></i>إدخال بيانات العملية
                </h1>

                <form id="operationForm" class="space-y-6">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-user ml-1"></i>اسم المريض
                            </label>
                            <input type="text" id="patientName" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-id-card ml-1"></i>رقم الملف
                            </label>
                            <input type="text" id="fileNumber" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-user-md ml-1"></i>الطبيب المعالج
                            </label>
                            <input type="text" id="doctorName" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-procedures ml-1"></i>نوع العملية
                            </label>
                            <select id="operationType" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">اختر نوع العملية</option>
                                <option value="جراحة عامة">جراحة عامة</option>
                                <option value="جراحة القلب">جراحة القلب</option>
                                <option value="جراحة المخ والأعصاب">جراحة المخ والأعصاب</option>
                                <option value="جراحة العظام">جراحة العظام</option>
                                <option value="جراحة التجميل">جراحة التجميل</option>
                                <option value="جراحة النساء">جراحة النساء</option>
                                <option value="أخرى">أخرى</option>
                            </select>
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-calendar ml-1"></i>تاريخ العملية
                            </label>
                            <input type="date" id="operationDate" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-clock ml-1"></i>وقت العملية
                            </label>
                            <input type="time" id="operationTime" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-hourglass-half ml-1"></i>مدة العملية (دقائق)
                            </label>
                            <input type="number" id="duration" min="1" required
                                   class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                        </div>

                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-2">
                                <i class="fas fa-stethoscope ml-1"></i>حالة المريض
                            </label>
                            <select id="patientStatus" required
                                    class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500">
                                <option value="">اختر الحالة</option>
                                <option value="مستقر">مستقر</option>
                                <option value="تحت الملاحظة">تحت الملاحظة</option>
                                <option value="حرج">حرج</option>
                                <option value="حساس">حساس</option>
                            </select>
                        </div>
                    </div>

                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-2">
                            <i class="fas fa-notes-medical ml-1"></i>ملاحظات
                        </label>
                        <textarea id="notes" rows="3"
                                  class="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                  placeholder="أي ملاحظات إضافية..."></textarea>
                    </div>

                    <div class="flex justify-end">
                        <button type="submit" 
                                class="bg-blue-600 text-white px-6 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500">
                            <i class="fas fa-save ml-2"></i>حفظ البيانات
                        </button>
                    </div>
                </form>

                <div id="successMessage" class="hidden bg-green-50 border border-green-200 text-green-700 px-4 py-3 rounded-md mt-4">
                    <i class="fas fa-check-circle ml-2"></i>
                    تم حفظ بيانات العملية بنجاح!
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/config.js"></script>
    <script src="assets/js/database.js"></script>
    <script src="assets/js/auth.js"></script>
    <script>
        // Check authentication
        if (!AuthManager.isAuthenticated()) {
            window.location.href = 'index.html';
        }

        document.getElementById('operationForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            
            const formData = {
                patientName: document.getElementById('patientName').value,
                fileNumber: document.getElementById('fileNumber').value,
                doctorName: document.getElementById('doctorName').value,
                operationType: document.getElementById('operationType').value,
                operationDate: document.getElementById('operationDate').value,
                operationTime: document.getElementById('operationTime').value,
                duration: parseInt(document.getElementById('duration').value),
                patientStatus: document.getElementById('patientStatus').value,
                notes: document.getElementById('notes').value,
                createdAt: new Date().toISOString()
            };

            try {
                await DatabaseManager.addOperation(formData);
                document.getElementById('successMessage').classList.remove('hidden');
                document.getElementById('operationForm').reset();
                
                setTimeout(() => {
                    document.getElementById('successMessage').classList.add('hidden');
                }, 3000);
            } catch (error) {
                alert('حدث خطأ أثناء حفظ البيانات');
            }
        });
    </script>
</body>
</html>